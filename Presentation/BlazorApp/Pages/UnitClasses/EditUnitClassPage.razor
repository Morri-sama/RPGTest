@page "/unitclasses/edit/{Id}"
@inherits PageBase

<MudContainer MaxWidth="MaxWidth.Large" Class="mt-4">
    <MudText Typo="Typo.h4" Align="Align.Left" Color="Color.Primary">Редактирование класса юнита ID:@_formContext.DataItem?.Id</MudText>  @*\\\ TODO: пересмотреть formContext*@
    <br />
    <EditForm Model="_formContext" OnValidSubmit="PutToApi">
        <MudCard>
            <MudCardContent>
                <MudGrid>
                    <MudItem xs="12">
                        <MudTextField Label="Название"
                                      @bind-Value="_formContext.Name" />
                    </MudItem>

                    <MudItem xs="12">
                        <MudTextField Label="Описание"
                                      @bind-Value="_formContext.Description" />
                    </MudItem>

                    <MudItem xs="12">
                        <MudSelect T="AttackType"
                                   Label="Тип атаки"
                                   @bind-Value="_formContext.AttackType">
                            <MudSelectItem T="AttackType"
                                           Value="AttackType.Melee">
                                Ближняя
                            </MudSelectItem>
                            <MudSelectItem T="AttackType"
                                           Value="AttackType.Range">
                                Дальняя
                            </MudSelectItem>
                            <MudSelectItem T="AttackType"
                                           Value="AttackType.Magical">
                                Магическая
                            </MudSelectItem>
                        </MudSelect>
                    </MudItem>

                    <MudItem xs="12">
                        <MudSelect T="DamageType"
                                   Label="Тип урона"
                                   @bind-Value="_formContext.DamageType">
                            <MudSelectItem T="DamageType" Value="DamageType.Physical">
                                Физический
                            </MudSelectItem>
                            <MudSelectItem T="DamageType" Value="DamageType.Magical">
                                Магический
                            </MudSelectItem>
                        </MudSelect>
                    </MudItem>

                    <MudItem xs="12">
                        <MudTextField Label="Базовый урон"
                                      @bind-Value="_formContext.BaseDamage" />
                    </MudItem>

                    <MudItem xs="12">
                        <MudTextField @bind-Value="_formContext.Condition"
                                      Label="Условие"
                                      Variant="Variant.Outlined"
                                      Lines="5"
                                      ReadOnly="true"
                                      FullWidth="true"
                                      HelperText="Может быть пустым"
                                      Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Edit" OnAdornmentClick="EditCondition" />
                    </MudItem>

                    <MudItem xs="12">
                        <MudTextField @bind-Value="_formContext.Formula"
                                      Label="Формула"
                                      Variant="Variant.Outlined"
                                      Lines="5"
                                      ReadOnly="true"
                                      FullWidth="true"
                                      HelperText="Применяется эта формула, если условия нет, либо оно верно"
                                      Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Edit" OnAdornmentClick="EditFormula" />
                    </MudItem>

                    <MudItem xs="12">
                        <MudTextField @bind-Value="_formContext.Formula2"
                                      Label="Формула"
                                      Variant="Variant.Outlined"
                                      Lines="5"
                                      ReadOnly="true"
                                      FullWidth="true"
                                      HelperText="Применяется эта формула, если условие ложно"
                                      Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Edit" OnAdornmentClick="EditFormula2" />
                    </MudItem>

                    <MudItem xs="12">
                        <MudSelect T="string"
                                   HelperText="Изменяемое свойство юнита после его атаки, если условия нет, либо оно верно"
                                   Label="Изменяемое свойство"
                                   @bind-Value="_formContext.TrueConditionActionChangeableProperty">
                            <MudSelectItem T="string" Value='("ТекущаяМана")'>
                                Текущая мана
                            </MudSelectItem>
                            <MudSelectItem T="string" Value='("ТекущееЗдоровье")'>
                                Текущее здоровье
                            </MudSelectItem>
                        </MudSelect>
                    </MudItem>

                    <MudItem xs="12">
                        <MudTextField @bind-Value="_formContext.PostTrueConditionAction"
                                      Label="Формула"
                                      Variant="Variant.Outlined"
                                      Lines="5"
                                      ReadOnly="true"
                                      FullWidth="true"
                                      HelperText="Применяется эта формула, если условия нет, либо оно верно"
                                      Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Edit" OnAdornmentClick="EditPostTrueCondition" />
                    </MudItem>

                    <MudItem xs="12">
                        <MudSelect T="string"
                                   HelperText="Изменяемое свойство юнита после его атаки, если ложно"
                                   Label="Изменяемое свойство"
                                   @bind-Value="_formContext.FalseConditionActionChangeableProperty">
                            <MudSelectItem T="string" Value='("ТекущаяМана")'>
                                Текущая мана
                            </MudSelectItem>
                            <MudSelectItem T="string" Value='("ТекущееЗдоровье")'>
                                Текущее здоровье
                            </MudSelectItem>
                        </MudSelect>
                    </MudItem>

                    <MudItem xs="12">
                        <MudTextField @bind-Value="_formContext.PostFalseConditionAction"
                                      Label="Формула"
                                      Variant="Variant.Outlined"
                                      Lines="5"
                                      ReadOnly="true"
                                      FullWidth="true"
                                      HelperText="Применяется эта формула, если условие ложно"
                                      Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Edit" OnAdornmentClick="EditPostFalseCondition" />
                    </MudItem>
                </MudGrid>
            </MudCardContent>
            <MudCardActions Class="d-flex flex-row-reverse">
                <MudButton ButtonType="ButtonType.Submit" Variant="Variant.Filled" Color="Color.Primary" Class="">Добавить</MudButton>
                <MudButton Variant="Variant.Text" Class="" OnClick="(e => NavigateBack())">Отмена</MudButton>
            </MudCardActions>
        </MudCard>
    </EditForm>

</MudContainer>